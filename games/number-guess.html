<!doctype html>
<html lang="ko" data-theme="dark">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>숫자 맞추기 게임</title>
  <link rel="stylesheet" href="../style.css">
  <style>
    .difficulty-setting { margin-bottom: 20px; display: flex; gap: 10px; align-items: center; }
    .difficulty-setting label { font-weight: bold; }
    #guessInput {
      width: 100px;
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid var(--input-border);
      background: var(--input-bg);
      color: var(--input-text-color);
      outline: none;
      margin-right: 10px;
    }
    #message { font-weight: bold; margin-top: 16px; min-height: 24px; }
    #attempts { opacity: 0.8; font-size: 14px; }
  </style>
</head>
<body>
  <div class="wrap">
    <a href="/" class="home-link">← 홈으로 돌아가기</a>
    <div class="row" style="margin-bottom:14px; align-items: center;">
      <h1 style="margin:0;">숫자 맞추기 게임</h1>
      <button id="themeToggle" class="btn2" style="margin-left: auto;">테마 변경</button>
    </div>

    <div class="card">
      <div class="difficulty-setting">
        <label>난이도:</label>
        <button class="btn2" data-difficulty="easy">쉬움</button>
        <button class="btn2" data-difficulty="normal">보통</button>
        <button class="btn2" data-difficulty="hard">어려움</button>
      </div>

      <p id="rangeText">1에서 100 사이의 숫자를 맞춰보세요.</p>

      <div class="row">
        <input type="number" id="guessInput" placeholder="숫자 입력">
        <button id="guessButton">추측</button>
        <button id="resetButton" class="btn2">재시작</button>
      </div>

      <div id="message"></div>
      <div id="attempts"></div>
    </div>
  </div>

  <script>
    // Theme switcher (same as other pages)
    const themeToggle = document.getElementById('themeToggle');
    const htmlEl = document.documentElement;
    const applyTheme = (theme) => {
      htmlEl.dataset.theme = theme;
      localStorage.setItem('theme', theme);
    };
    themeToggle.addEventListener('click', () => {
      const currentTheme = htmlEl.dataset.theme === 'dark' ? 'light' : 'dark';
      applyTheme(currentTheme);
    });
    const savedTheme = localStorage.getItem('theme');
    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    if (savedTheme) { applyTheme(savedTheme); }
    else { applyTheme(prefersDark ? 'dark' : 'light'); }

    // Game Logic
    const guessInput = document.getElementById('guessInput');
    const guessButton = document.getElementById('guessButton');
    const resetButton = document.getElementById('resetButton');
    const message = document.getElementById('message');
    const attemptsDiv = document.getElementById('attempts');
    const rangeText = document.getElementById('rangeText');
    const difficultyButtons = document.querySelectorAll('.difficulty-setting button');

    let maxNumber = 100;
    let targetNumber;
    let attempts;
    let activeDifficultyButton;

    function setDifficulty(difficulty) {
      if (activeDifficultyButton) {
        activeDifficultyButton.classList.remove('active'); // You might need to add an .active class style
      }
      
      const config = {
        easy: 50,
        normal: 100,
        hard: 200
      };
      maxNumber = config[difficulty];
      rangeText.textContent = `1에서 ${maxNumber} 사이의 숫자를 맞춰보세요.`;
      
      const btn = document.querySelector(`[data-difficulty="${difficulty}"]`);
      if(btn) {
        btn.classList.add('active'); // Style this class
        activeDifficultyButton = btn;
      }
      
      resetGame();
    }

    function resetGame() {
      targetNumber = Math.floor(Math.random() * maxNumber) + 1;
      attempts = 0;
      message.textContent = '';
      attemptsDiv.textContent = '';
      guessInput.value = '';
      guessInput.disabled = false;
      guessButton.disabled = false;
    }

    function handleGuess() {
      const userGuess = parseInt(guessInput.value, 10);
      if (isNaN(userGuess)) {
        message.textContent = '유효한 숫자를 입력하세요.';
        return;
      }

      attempts++;
      attemptsDiv.textContent = `시도 횟수: ${attempts}`;

      if (userGuess === targetNumber) {
        message.textContent = `축하합니다! ${attempts}번 만에 맞추셨습니다!`;
        message.style.color = '#28a745'; // Success color
        guessInput.disabled = true;
        guessButton.disabled = true;
      } else if (userGuess < targetNumber) {
        message.textContent = '너무 낮아요! 더 높은 숫자를 시도해보세요.';
        message.style.color = '';
      } else {
        message.textContent = '너무 높아요! 더 낮은 숫자를 시도해보세요.';
        message.style.color = '';
      }
      guessInput.value = '';
      guessInput.focus();
    }
    
    guessButton.addEventListener('click', handleGuess);
    guessInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        handleGuess();
      }
    });
    resetButton.addEventListener('click', resetGame);
    
    difficultyButtons.forEach(button => {
      button.addEventListener('click', () => {
        setDifficulty(button.dataset.difficulty);
      });
    });

    // Initialize
    setDifficulty('normal');
  </script>
</body>
</html>
